<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Einfache Regression | Statistische Modellbildung</title>
  <meta name="description" content="Einführung in die statistische Modellbildung">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Einfache Regression | Statistische Modellbildung />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="Images/Cover.PNG" />
  <meta property="og:description" content="Einführung in die statistische Modellbildung" />
  <meta name="github-repo" content="wgruber/Modellbildung" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Einfache Regression | Statistische Modellbildung />
  
  <meta name="twitter:description" content="Einführung in die statistische Modellbildung" />
  <meta name="twitter:image" content="Images/Cover.PNG" />

<meta name="author" content="Walter Gruber">


<meta name="date" content="2019-03-07">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="korrelationen.html">
<link rel="next" href="multiple-regression.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Vorbemerkung</a></li>
<li class="chapter" data-level="" data-path="einleitung.html"><a href="einleitung.html"><i class="fa fa-check"></i>Einleitung</a></li>
<li><a href="allgemeine-definition-des-begriffs-modell.html#allgemeine-definition-des-begriffs-modell">Allgemeine Definition des Begriffs <em>Modell</em></a></li>
<li class="part"><span><b>Teil I: Begrifflichkeiten</b></span></li>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html"><i class="fa fa-check"></i>Statistisches Modell</a><ul>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html#modellbildung"><i class="fa fa-check"></i>Modellbildung</a></li>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html#kennzeichen-eines-modelles"><i class="fa fa-check"></i>Kennzeichen eines Modelles</a><ul>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html#zyklus-der-modellbildung"><i class="fa fa-check"></i>Zyklus der Modellbildung</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html#grundlagen-der-statistischen-modellbildung"><i class="fa fa-check"></i>Grundlagen der statistischen Modellbildung</a><ul>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html#deskriptive-statistik"><i class="fa fa-check"></i>Deskriptive Statistik</a></li>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html#explorative-datenanalyse-eda"><i class="fa fa-check"></i>Explorative Datenanalyse (EDA)</a></li>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html#inferenzstatistik"><i class="fa fa-check"></i>Inferenzstatistik</a></li>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html#pradiktive-statistik"><i class="fa fa-check"></i>Prädiktive Statistik</a></li>
<li class="chapter" data-level="" data-path="statistisches-modell.html"><a href="statistisches-modell.html#mechanististische-statistik"><i class="fa fa-check"></i>Mechanististische Statistik</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Teil II: Modelle mit einer Variablen</b></span></li>
<li class="chapter" data-level="" data-path="datensatz.html"><a href="datensatz.html"><i class="fa fa-check"></i>Datensatz</a></li>
<li class="chapter" data-level="" data-path="deskriptive-statistik-1.html"><a href="deskriptive-statistik-1.html"><i class="fa fa-check"></i>Deskriptive Statistik</a><ul>
<li class="chapter" data-level="" data-path="deskriptive-statistik-1.html"><a href="deskriptive-statistik-1.html#codebooks-in-r"><i class="fa fa-check"></i>Codebooks in R</a><ul>
<li class="chapter" data-level="" data-path="deskriptive-statistik-1.html"><a href="deskriptive-statistik-1.html#tabellen"><i class="fa fa-check"></i>Tabellen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="mittelwerts-modell.html"><a href="mittelwerts-modell.html"><i class="fa fa-check"></i>Mittelwerts-Modell</a><ul>
<li><a href="mittelwerts-modell.html#modell-idealer-daten">Modell <em>idealer</em> Daten</a></li>
<li><a href="mittelwerts-modell.html#modell-schiefer-daten">Modell <em>schiefer</em> Daten</a><ul>
<li class="chapter" data-level="" data-path="mittelwerts-modell.html"><a href="mittelwerts-modell.html#aufgabenstellung-1"><i class="fa fa-check"></i>Aufgabenstellung 1</a></li>
<li class="chapter" data-level="" data-path="mittelwerts-modell.html"><a href="mittelwerts-modell.html#graphische-darstellung"><i class="fa fa-check"></i>Graphische Darstellung</a></li>
<li class="chapter" data-level="" data-path="mittelwerts-modell.html"><a href="mittelwerts-modell.html#bemerkung-ausreier"><i class="fa fa-check"></i>Bemerkung Ausreißer</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mittelwerts-modell.html"><a href="mittelwerts-modell.html#guteschatzung-des-mittelwertsmodells"><i class="fa fa-check"></i>Güteschätzung des Mittelwertsmodells</a><ul>
<li><a href="mittelwerts-modell.html#erlauterung-zum-se">Erläuterung zum <span class="math inline">\(SE\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mittelwerts-modell.html"><a href="mittelwerts-modell.html#konfidenzintervall-um-den-mittelwert"><i class="fa fa-check"></i>Konfidenzintervall um den Mittelwert</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="codebook-cps85.html"><a href="codebook-cps85.html"><i class="fa fa-check"></i>Codebook CPS85</a></li>
<li class="chapter" data-level="" data-path="losungen.html"><a href="losungen.html"><i class="fa fa-check"></i>Lösungen</a><ul>
<li class="chapter" data-level="" data-path="losungen.html"><a href="losungen.html#aufgabe_1"><i class="fa fa-check"></i>Aufgabe_1</a></li>
</ul></li>
<li class="part"><span><b>Teil III: Modelle mit mehr Variablen</b></span></li>
<li class="chapter" data-level="" data-path="korrelationen.html"><a href="korrelationen.html"><i class="fa fa-check"></i>Korrelationen</a><ul>
<li class="chapter" data-level="" data-path="korrelationen.html"><a href="korrelationen.html#kausalitat"><i class="fa fa-check"></i>Kausalität</a></li>
<li class="chapter" data-level="" data-path="korrelationen.html"><a href="korrelationen.html#linearitat"><i class="fa fa-check"></i>Linearität</a></li>
<li class="chapter" data-level="" data-path="korrelationen.html"><a href="korrelationen.html#korrelationskoeffizienten"><i class="fa fa-check"></i>Korrelationskoeffizienten</a></li>
<li class="chapter" data-level="" data-path="korrelationen.html"><a href="korrelationen.html#herleitung"><i class="fa fa-check"></i>Herleitung</a><ul>
<li class="chapter" data-level="" data-path="korrelationen.html"><a href="korrelationen.html#beispiel"><i class="fa fa-check"></i>Beispiel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="einfache-regression.html"><a href="einfache-regression.html"><i class="fa fa-check"></i>Einfache Regression</a><ul>
<li class="chapter" data-level="" data-path="einfache-regression.html"><a href="einfache-regression.html#definitionen"><i class="fa fa-check"></i>Definitionen</a><ul>
<li class="chapter" data-level="" data-path="einfache-regression.html"><a href="einfache-regression.html#berechnung-der-koeffizienten"><i class="fa fa-check"></i>Berechnung der Koeffizienten</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="einfache-regression.html"><a href="einfache-regression.html#modellanwendung"><i class="fa fa-check"></i>Modellanwendung</a><ul>
<li class="chapter" data-level="" data-path="einfache-regression.html"><a href="einfache-regression.html#aufgabe-slr-1"><i class="fa fa-check"></i>Aufgabe SLR 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="einfache-regression.html"><a href="einfache-regression.html#residualanalyse"><i class="fa fa-check"></i>Residualanalyse</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i>Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="multiple-regression.html"><a href="multiple-regression.html#definition"><i class="fa fa-check"></i>Definition</a></li>
<li class="chapter" data-level="" data-path="multiple-regression.html"><a href="multiple-regression.html#modellvergleich"><i class="fa fa-check"></i>Modellvergleich</a></li>
<li class="chapter" data-level="" data-path="multiple-regression.html"><a href="multiple-regression.html#aufgabe-mlr-1"><i class="fa fa-check"></i>Aufgabe MLR 1</a></li>
<li class="chapter" data-level="" data-path="multiple-regression.html"><a href="multiple-regression.html#wahl-relevanter-pradiktoren"><i class="fa fa-check"></i>Wahl relevanter Prädiktoren</a></li>
<li class="chapter" data-level="" data-path="multiple-regression.html"><a href="multiple-regression.html#sequentielle-modellbildung"><i class="fa fa-check"></i>Sequentielle Modellbildung</a></li>
<li class="chapter" data-level="" data-path="multiple-regression.html"><a href="multiple-regression.html#modellvergleich-durch-aic"><i class="fa fa-check"></i>Modellvergleich durch AIC</a></li>
<li class="chapter" data-level="" data-path="multiple-regression.html"><a href="multiple-regression.html#kreuzvalidierung"><i class="fa fa-check"></i>Kreuzvalidierung</a></li>
<li class="chapter" data-level="" data-path="multiple-regression.html"><a href="multiple-regression.html#voraussetzungen-mlr"><i class="fa fa-check"></i>Voraussetzungen MLR</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="losungen-1.html"><a href="losungen-1.html"><i class="fa fa-check"></i>Lösungen</a><ul>
<li class="chapter" data-level="" data-path="losungen-1.html"><a href="losungen-1.html#aufgabe-slr-1-lsg"><i class="fa fa-check"></i>Aufgabe SLR 1 Lsg</a></li>
<li class="chapter" data-level="" data-path="losungen-1.html"><a href="losungen-1.html#aufgabe-mlr-1-lsg"><i class="fa fa-check"></i>Aufgabe MLR 1 Lsg</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistische Modellbildung</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="einfache-regression" class="section level1 unnumbered">
<h1>Einfache Regression</h1>
<p>Will man bei der Korrelationsanalyse den Zusammenhang von Variablen beschreiben, versucht man in der Regressionsanalyse eine Variable mittels einer linearen Funktion durch eine (oder mehrere) andere Variablen zur <em>erklären</em>. Nichts desto trotz sind Korrelation und Regression sehr eng miteinander verknüpft.</p>
<p>Der Begriff Regression tauchte erstmalig 1877 in einer von Sir Francis Galton abgefassten wissenschaftlichen Studie auf. In einer späteren Studie über die Körpergröße von Vätern und deren Söhnen wendete er den Gedanken der Regressionsanalyse erneut an.</p>
<p>Er fand heraus, dass Söhne sehr großer (kleiner) Väter zwar groß (klein), aber etwas kleiner (größer) sind als diese. Die Körpergröße entwickelt sich somit immer wieder in Richtung des Durchschnitts zurück. Als Engländer bezeichnete Galton diesen Prozess als <em>Regression</em><a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a>.</p>
<p>Zwischen der Körpergröße der Söhne und der Väter besteht somit ein Zusammenhang, dessen Stärke mit Hilfe der Korrelation ausgedrückt werden könnte. Im Unterschied zur Korrelationsanalyse unterstellt man bei der Regressionsanalyse jedoch sehr oft auch die kausale Richtung des Zusammenhangs:</p>
<blockquote>
<p>Die Körpergröße der Söhne ist abhängig von der Körpergröße des Vaters und nicht umgekehrt.</p>
</blockquote>
<p>Entsprechend bezeichnete Galton:</p>
<ul>
<li>die Größe der Söhne als <em>abhängige Variable</em> (<em>dependent variable</em>, <strong>DV</strong>) und</li>
<li>die Größe der Väter als <em>unabhängige Variable</em> (<em>independent variable</em>, <strong>IV</strong>).</li>
</ul>
<p>Häufig werden die Variable die vorhergesagt werden soll bei der Regression <em>Kriterium</em> (<span class="math inline">\(y_i\)</span>)und die Variable(n) die für die Vorhersage eingesetzt wird/werden <em>Prädiktor(n)</em> (<span class="math inline">\(x_{1i}\)</span>)<a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a> genannt. Anhand des Prädiktors wird demzufolge das Kriterium vorhergesagt.</p>
<p>Der Schluss, dass die Regression die Kausalität von Zusammenhängen <em>beweist</em>, ist damit allerdings nicht (immer) erlaubt. Die Kausalität (Wirkungsrichtung) muss zuvor theoretisch abgeleitet werden, bevor sie empirisch (mit Hilfe der Regression) bewiesen werden kann. So ist die Richtung der Kausalität bei Fragen wie:</p>
<ul>
<li>ist es das Alter des Bräutigams, welches das Alter der Braut bestimmt, oder umgekehrt?</li>
<li>beeinflusst sich das Alter der verheirateten Paare gar gegenseitig?</li>
</ul>
<p>nicht zu bestimmen. Manchmal ist die Kausalität jedoch sehr offensichtlich:</p>
<ul>
<li>der Blutdruck hat keinen Einfluss auf das Alter, sondern das Alter hat einen Einfluss auf den Blutdruck.</li>
<li>die Körpergröße hat einen Einfluss auf das Körpergewicht, aber umgekehrt lässt sich dieser Zusammenhang wohl theoretisch kaum herleiten.</li>
<li>mit Zunahme des <span class="math inline">\(CO_2\)</span> Gehaltes in der Atmosphäre steigt die durchschnittliche Temperatur, eine umgekehrte Wirkungsrichtung ist aber auszuschließen (da hätten wir in südlichen Ländern ein kleines Problem!).</li>
</ul>
<p>Die Regression ermöglicht jedenfalls unter bestimmten Umständen<a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a> gute, bzw. bestmögliche Vorhersage für eine Variable. Folgernd aus dem eben gesagten, sollte nochmals klargestellt werden, dass im Gegensatz zur Korrelation festgelegt werden muss, welche Variable durch eine andere Variable vorhergesagt werden soll.</p>
<div id="definitionen" class="section level2 unnumbered">
<h2>Definitionen</h2>
<p>Die formale Definition eines einfachen linearen Modells ist:</p>
<span class="math display" id="eq:LinModFehler">\[\begin{equation} 
  y_i = b_0 + b_1 \cdot x_{1i} + \varepsilon_i
  \tag{8}
\end{equation}\]</span>
<p>Die wesentlichen Parameter dieses einfachen Modells sind:</p>
<ol style="list-style-type: decimal">
<li>Konstanter Term (intercept) <span class="math inline">\(b_0\)</span>: jener Wert den <span class="math inline">\(y_i\)</span> einnimmt, wenn <span class="math inline">\(x_{1i} = 0\)</span> ist.</li>
<li>Steigung (slope) <span class="math inline">\(b_1\)</span>: die Zunahme von <span class="math inline">\(y_i\)</span>, wenn <span class="math inline">\(x_{1i}\)</span> sich um eine Einheit erhöht.</li>
</ol>
<p>Des Weiteren berücksichtigt dieses Modell auch einen Fehler (<span class="math inline">\(\varepsilon_i\)</span>). Damit kommt auch ein ganz zentraler Teil bei der Modellbildung zum Ausdruck. Die meisten Modelle definieren sich also aus:</p>
<span class="math display" id="eq:AllgModellvorstellung">\[\begin{equation} 
  \textrm{wahrer Wert} = \textrm{Modell} + \textrm{Fehler}
  \tag{9}
\end{equation}\]</span>
<p>Daraus lässt sich auch folgende Erkenntnis bezüglich des Modells direkt ableiten:</p>
<ol style="list-style-type: decimal">
<li>Je kleiner die Summe der Fehler sind, desto besser ist das Modell.</li>
<li>Je genauer das Modell, desto kleiner wird auch der Fehler sein.</li>
</ol>
<p>Mit dieser Erkenntnis wird auch klar, dass i.A. ein ganz einfaches Modell (mit einem einzigen Prädiktor) nur zu einer bedingten Reduktion des Fehlers geeignet ist. Wir werden uns im weiteren Verlauf mit erweiterten Modellen beschäftigen, wollen aber zunächst die Eigenschaften des einfachen linearen Modells näher betrachten. Im folgenden Link findet man eine gute <a href="https://phet.colorado.edu/sims/html/least-squares-regression/latest/least-squares-regression_en.html" target="_blank">Veranschaulichung des einfachen linearen Modells</a>.</p>
<p>Betrachtet man das Modell isoliert (also ohne Fehlerterm), ist folgende Schreibweise üblich:</p>
<span class="math display" id="eq:LinMod">\[\begin{equation} 
  \hat{y}_i = b_0 + b_1 \cdot x_{1i}
  \tag{10}
\end{equation}\]</span>
<div id="berechnung-der-koeffizienten" class="section level3 unnumbered">
<h3>Berechnung der Koeffizienten</h3>
<p>Für die Berechnung der Koeffizienten wird das Kriterium der kleinste Quadrate (MLS) angewandet. Einfach ausgedrückt wird eine Gerade durch die beobachteten Daten gesucht, die folgenden Eigenschaften aufweist:</p>
<ol style="list-style-type: decimal">
<li>die Summe der quadratischen Abstände jeder Beobachtung zum entsprechenden Punkt auf der Geraden ist ein Minimum, also <span class="math inline">\(\sum_{i=1}^{N} \varepsilon_i^2 = min\)</span>.</li>
<li>es gibt keine andere Gerade die eine kleinere Summe dieser Fehler liefert.</li>
</ol>
<p>Die Berechnung der Parameter entspricht daher einer Extremwertaufgabe, d.h. die partiellen Ableitungen werden auf Null gesetzt. Daraus lassen sich dann die Parameter <span class="math inline">\(b_0, b_1\)</span> berechnent. Details dazu siehe <a href="https://de.wikipedia.org/wiki/Einfache_lineare_Regression" target="_blank">Wikipedia</a>.</p>
</div>
</div>
<div id="modellanwendung" class="section level2 unnumbered">
<h2>Modellanwendung</h2>
<p>Zur Anwendung eines einfachen linearen Modell betrachten wir wiederum die bereits bekannten Daten aus dem Datensatz <em>CPS85</em>. Diese Mal wollen wir das Gehalt (<em>wage</em>) durch die Ausbildungsdauer (<em>educ</em> in Jahren) vorhersagen. Formal lautet das Modell demnach:</p>
<span class="math display" id="eq:LinModBsp1">\[\begin{equation} 
   \hat{\textrm{wage}} = b_0 + b_1 \cdot \textrm{educ}
  \tag{11}
\end{equation}\]</span>
<p>Die Werte der Parameter <span class="math inline">\(b_0, b_1\)</span> können für dieses Beispiel entsprechend der obigen Erläuterung folgendermaßen interpretiert werden:</p>
<ol style="list-style-type: decimal">
<li>Für eine Person mit keiner Ausbildung (<span class="math inline">\(\textrm{wage} = x_{1i} = 0\)</span>) wird durch das Modell ein Einkommen <span class="math inline">\(y_i = b_0\)</span> vorhergesagt.</li>
<li>Erhöht man die Ausbildungsdauer <span class="math inline">\(x_{1i}\)</span> um ein Jahr, steigt der Gehalt <span class="math inline">\(y_i\)</span> um das <span class="math inline">\(b_1\)</span>-fache an.</li>
</ol>
<p>Kopiere zur Veranschaulichung folgenden Code in dein R-Script und führe diesen aus.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  DF &lt;-<span class="st"> </span>CPS85
  <span class="kw">ggplot</span>(CPS85, <span class="kw">aes</span>(<span class="dt">x =</span> educ, <span class="dt">y =</span> wage)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm, <span class="dt">se=</span><span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="03_Modelle_Mehr_Variablen_files/figure-html/Modell1-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  model_<span class="dv">1</span>     &lt;-<span class="st"> </span><span class="kw">lm</span>(wage <span class="op">~</span><span class="st"> </span>educ, <span class="dt">data =</span> CPS85)
  <span class="kw">pander</span>(<span class="kw">summary</span>(model_<span class="dv">1</span>))</code></pre></div>
<table style="width:88%;">
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-0.746</td>
<td align="center">1.045</td>
<td align="center">-0.7135</td>
<td align="center">0.4758</td>
</tr>
<tr class="even">
<td align="center"><strong>educ</strong></td>
<td align="center">0.7505</td>
<td align="center">0.07873</td>
<td align="center">9.532</td>
<td align="center">5.474e-20</td>
</tr>
</tbody>
</table>
<table style="width:86%;">
<caption>Fitting linear model: wage ~ educ</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">534</td>
<td align="center">4.754</td>
<td align="center">0.1459</td>
<td align="center">0.1443</td>
</tr>
</tbody>
</table>
<p>Die in der Tabelle angegebenen Werte der Spalte <strong>Estimate</strong> entsprechen dabei den Parametern <span class="math inline">\(b_0, b_1\)</span> des Modells. Eine weitere wesentliche Kennzahl für die Interpretation des Modells ist der Spalte <span class="math inline">\(R^2\)</span> zu entnehmen. Dieser Wert wird als <em>Determinationskoeffizient</em><a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a> bezeichnet. Umgerechnet in % (im vorliegenden Beispiel also 14.43%) besagt der Wert, wie viel der Variablität des Gehaltes durch den Prädiktor Ausbilung erklärt wird. Wir werden im weiteren Verlauf noch öfter auf diesen Kennwert zurückkommen.</p>
<p>Welche Gehälter würden für Ausbildungszeiten zwischen 10 und 14 Jahren vorhergesagt werden? Kopiere folgenden Code in dein R-Script und führe diesen aus. Änder auch den Wertebereich der Prädiktoren und beobachte was dabei passiert!</p>
<p>Im Vergleich zum Mittelwert-Modell zeigt sich mit steigender Ausbildung ein höheres Einkommen. Der Fehler bei der Vorhersage des Einkommens wird sich daher durch diese Modellvorstellung verringern (mehr zur Abschätzung der Fehlerreduktion später).</p>
<div id="aufgabe-slr-1" class="section level3 unnumbered">
<h3>Aufgabe SLR 1</h3>
<p>Öffne ein neues R-Script und kopiere die bereits bekannte Kopfzeile in diese Datei. Speichere anschließend das Skript unter dem Namen <em>SLR_Aufgabe1.R</em>. Bearbeite nun folgende Aufgabenstellungen:</p>
<ul>
<li>Lade die Datei “<em>Album Sales 1.dat</em>”</li>
<li>erstelle ein einfaches Streudiagramm mit Sales auf der x- und adverts auf der y-Achse.</li>
<li>erstelle ein einfaches lineares Modell zur Vorhersage der Verkaufszahlen (<em>sales</em>) durch die Variable <em>adverts</em>.</li>
<li>Wie stark korrelliert der Prädiktor mit dem Kriterium?</li>
<li>Wie viel Varianz wird vom Kriterium durch den Prädiktor aufgeklärt?</li>
<li>Ist das erstellte Modell signifikant besser, als dan Null-Modell?</li>
<li>Welchen Wert würde das Modell für Werbeausgaben = 100 vorhersagen?</li>
</ul>
<p><a href="losungen-1.html#aufgabe-slr-1-lsg">Lösung Aufgabe SLR 1</a></p>
</div>
</div>
<div id="residualanalyse" class="section level2 unnumbered">
<h2>Residualanalyse</h2>
<p>Ein zentrales Thema der Modellbildung ist die Beurteilung und (statistische) Auswertung der Abweichungen des Modells von den Beobachtungen (Fehler, Residum). Folgende Kennwerte bilden die Möglichkeit, die Güte des Modells abzuschätzen:</p>
<ol style="list-style-type: decimal">
<li><em>Vorhergesagte Werte</em>: vorhergesagte Werte der Regressionsgleichung (= Werte die auf der Geraden liegen).
<ul>
<li>Nicht standardisiert: der Wert, den das Modell für die abhängige Variable vorhersagt.</li>
<li>Standardisiert: <span class="math inline">\(z\)</span>-Transformierte vorhergesagte Werte.</li>
<li>Korrigiert: der vorhergesagte Wert für einen Fall, wenn dieser Fall von der Berechnung der Regressionskoeffizienten ausgeschlossen ist.</li>
<li>Standardfehler des Mittelwerts: Standardfehler der vorhergesagten Werte. Ein Schätzwert der Standardabweichung des Durchschnittswertes der abhängigen Variablen für die Fälle, die dieselben Werte für die unabhängigen Variablen haben.</li>
</ul></li>
<li><em>Residuen</em>: tatsächliche Wert der abhängigen Variablen minus des vorhergesagten Werts aus der Regressionsgleichung.
<ul>
<li>Nicht standardisiert: Die Differenz zwischen einem beobachteten Wert und dem durch das Modell vorhergesagten Wert.</li>
<li>Standardisiert: Der Quotient aus dem Residuum und einer Schätzung seiner Standardabweichung. Standardisierte Residuen, auch bekannt als Pearson-Residuen, haben einen Mittelwert von 0 und eine Standardabweichung von 1.</li>
<li>Studentisiert: Ein Residuum, das durch seine geschätzte Standardabweichung geteilt wird, die je nach der Distanz zwischen den Werten der unabhängigen Variablen des Falles und dem Mittelwert der unabhängigen Variablen von Fall zu Fall variiert.</li>
<li>Ausgeschlossen: Das Residuum für einen Fall, wenn dieser Fall nicht in die Berechnung der Regressionskoeffizienten eingegangen ist. Dies ist die Differenz zwischen dem Wert der abhängigen Variablen und dem korrigierten Schätzwert.</li>
<li>Studentisiert und ausgeschlossen: Der Quotient aus dem ausgeschlossenen Residuum eines Falles und seinem Standardfehler. Die Differenz zwischen einem studentisierten ausgeschlossenen Residuum und dem zugehörigen studentisierten Residuum gibt an, welchen Unterschied die Entfernung eines Falles für dessen eigene Vorhersage bewirkt.</li>
</ul></li>
<li><em>Distanzen</em>: Maße zum Auffinden von Fällen mit ungewöhnlichen Wertekombinationen bei den unabhängigen Variablen und von Fällen, die einen großen Einfluss auf das Modell haben könnten.
<ul>
<li>Mahalanobis: Dieses Maß gibt an, wie weit die Werte der unabhängigen Variablen eines Falls vom Mittelwert aller Fälle abweichen. Eine große Mahalanobis-Distanz charakterisiert einen Fall, der bei einer oder mehreren unabhängigen Variablen Extremwerte besitzt.</li>
<li>Cook: Ein Maß dafür, wie stark sich die Residuen aller Fälle ändern würden, wenn ein spezieller Fall von der Berechnung der Regressionskoeffizienten ausgeschlossen würde. Ein großer Wert der Cook-Distanz zeigt an, dass der Ausschluss eines Falles von der Berechnung der Regressionskoeffizienten die Koeffizienten substanziell verändert.</li>
<li>Hebelwerte: Werte, die den Einfluss eines Punktes auf die Anpassung der Regression messen. Der zentrierte Wert für die Hebelwirkung bewegt sich zwischen 0 (kein Einfluss auf die Anpassung) und <span class="math inline">\((N-1)/N\)</span>.</li>
</ul></li>
<li><em>Vorhersageintervalle</em>: obere und untere Grenzen sowohl für Mittelwert als auch für einzelne Vorhersageintervalle.
<ul>
<li>Mittelwert: Unter- und Obergrenze (zwei Variablen) für das Vorhersageintervall für den mittleren vorhergesagten Wert.</li>
<li>Individuell: Unter- und Obergrenzen (zwei Variablen) für das Vorhersageintervall der abhängigen Variablen für einen Einzelfall.</li>
<li>Konfidenzintervall: Geben Sie einen Wert zwischen 1 und 99,99 ein, um das Konfidenzniveau für die beiden Vorhersageintervalle festzulegen. Wählen Sie <em>Mittelwert</em> oder <em>Individuell</em> aus, bevor Sie diesen Wert eingeben. Typische Werte für Konfidenzniveaus sind 90, 95 und 99.</li>
</ul></li>
<li><em>Einflussstatistiken</em>: Änderung in den Regressionskoeffizienten (DfBeta(s)) und vorhergesagten Werten (DfFit), die sich aus dem Ausschluss eines bestimmten Falls ergeben.
<ul>
<li>Differenz in Beta: entspricht der Änderung im Regressionskoeffizienten, die sich aus dem Ausschluss eines bestimmten Falls ergibt. Für jeden Term im Modell, einschließlich der Konstanten, wird ein Wert berechnet.</li>
<li>Standardisiertes DfBeta: die Änderung des Regressionskoeffizienten, die sich durch den Ausschluss eines bestimmten Falls ergibt. Es empfiehlt sich, Fälle mit absoluten Werten größer als <span class="math inline">\(2/\sqrt{N}\)</span> zu überprüfen, wenn <span class="math inline">\(N\)</span> die Anzahl der Fälle darstellt. Für jeden Term im Modell, einschließlich der Konstanten, wird ein Wert berechnet.</li>
<li>DfFit: Differenz im Anpassungswert ist die Änderung im vorhergesagten Wert, die sich aus dem Ausschluss eines bestimmten Falls ergibt.</li>
<li>Standardisiertes DfFit: Änderung des vorhergesagten Werts, die sich durch den Ausschluss eines bestimmten Falls ergibt. Es empfiehlt sich, Fälle mit absoluten Werten <span class="math inline">\(&gt; 2/\sqrt{p/N}\)</span> zu überprüfen, wobei <span class="math inline">\(p\)</span> die Anzahl der unabhängigen Variablen im Modell und <span class="math inline">\(N\)</span> die Anzahl der Fälle darstellt.</li>
<li>Kovarianzverhältnis: Verhältnis der Determinante der Kovarianzmatrix bei Ausschluss eines bestimmten Falls von der Berechnung der Regressionskoeffizienten zur Determinante der Kovarianzmatrix bei Einschluss aller Fälle. Wenn der Quotient dicht bei 1 liegt, beeinflusst der ausgeschlossene Fall die Kovarianzmatrix nur unwesentlich.</li>
</ul></li>
</ol>
<p>Nachfolgender Code und Tabelle zeigen die Auswertung der Residualanalyse für das oben erstellte <em>model_1</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  CPS85_Res &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Res     =</span> <span class="kw">round</span>(<span class="kw">resid</span>(model_<span class="dv">1</span>), <span class="dv">2</span>),
                          <span class="dt">StdRes  =</span> <span class="kw">round</span>(<span class="kw">rstandard</span>(model_<span class="dv">1</span>), <span class="dv">2</span>),
                          <span class="dt">StudRes =</span> <span class="kw">round</span>(<span class="kw">rstudent</span>(model_<span class="dv">1</span>), <span class="dv">2</span>),
                          <span class="co"># Cook    = round(cooks.distance(model_1), 2),</span>
                          <span class="co"># DFBeta  = round(dfbeta(model_1), 2),</span>
                          <span class="dt">DF5Fit  =</span> <span class="kw">round</span>(<span class="kw">dffits</span>(model_<span class="dv">1</span>), <span class="dv">2</span>),
                          <span class="co"># Lev     = round(hatvalues(model_1), 2),</span>
                          <span class="dt">CovRat  =</span> <span class="kw">round</span>(<span class="kw">covratio</span>(model_<span class="dv">1</span>), <span class="dv">2</span>))
  <span class="kw">pander</span>(<span class="kw">head</span>(CPS85_Res))</code></pre></div>
<table style="width:62%;">
<colgroup>
<col width="11%" />
<col width="12%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Res</th>
<th align="center">StdRes</th>
<th align="center">StudRes</th>
<th align="center">DF5Fit</th>
<th align="center">CovRat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2.24</td>
<td align="center">0.47</td>
<td align="center">0.47</td>
<td align="center">0.03</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center">-2.76</td>
<td align="center">-0.58</td>
<td align="center">-0.58</td>
<td align="center">-0.03</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">-4.46</td>
<td align="center">-0.94</td>
<td align="center">-0.94</td>
<td align="center">-0.04</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2.24</td>
<td align="center">0.47</td>
<td align="center">0.47</td>
<td align="center">0.02</td>
<td align="center">1.01</td>
</tr>
<tr class="odd">
<td align="center">6.74</td>
<td align="center">1.42</td>
<td align="center">1.42</td>
<td align="center">0.07</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">-2.26</td>
<td align="center">-0.48</td>
<td align="center">-0.48</td>
<td align="center">-0.03</td>
<td align="center">1.01</td>
</tr>
</tbody>
</table>
<p>Mit der Residualanalyse kann man auf relativ einfache Weise jene Werte ermitteln (und auch graphisch darstellen), die z.B. um mehr als eine Standardabweichung abweichen. Diese Werte könnte man nochmals genauer untersuchen und gegebenenfalls vor einer weiterführenden Analyse ausschließen<a href="#fn10" class="footnoteRef" id="fnref10"><sup>10</sup></a>. Keinesfalls sollte sie jedoch dazu verwendet werden, um einen erwünschten Effekt durch schrittweises löschen störender Daten zu erreichen! Kopiere folgenden Code in dein R-Script und führe diesen aus.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="co"># Liste standardisierte Residuen &gt; |1|</span>
  Ind_Res &lt;-<span class="st"> </span><span class="kw">which</span>((CPS85_Res<span class="op">$</span>StdRes <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>CPS85_Res<span class="op">$</span>StdRes <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span><span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)
  <span class="co"># Anzeige der Werte von wage und educ sowie der Standardisierten Residuen</span>
  <span class="co"># fÃ¼r jene FÃ¤lle, deren Residuen Ã¼ber 1 SD abweichen.</span>
  
  <span class="co"># pander(data.frame(Indizes = Ind_Res,</span>
  <span class="co">#                   wage = CPS85$wage[Ind_Res],</span>
  <span class="co">#                   educ = CPS85$educ[Ind_Res] ,</span>
  <span class="co">#                   CPS85_Res$StdRes[Ind_Res]))</span>
  
  p_Res1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(CPS85, <span class="kw">aes</span>(<span class="dt">x =</span> educ, <span class="dt">y =</span> wage)) <span class="op">+</span><span class="st"> </span>
<span class="st">            </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">            </span><span class="kw">geom_point</span>(<span class="dt">data=</span>CPS85[Ind_Res,],<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>,<span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">            </span><span class="kw">theme_bw</span>()
  <span class="kw">print</span>(p_Res1, <span class="dt">comment =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="03_Modelle_Mehr_Variablen_files/figure-html/Modell1_ResidStat_Graph1-1.png" width="672" /></p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>was mit <em>Rückschritt</em>, <em>Rückkehr</em> oder <em>rückläufige Entwicklung</em> übersetzt werden kann (siehe <a href="https://link.springer.com/chapter/10.1007/978-3-8349-7071-8_5">Deskriptive Statistik und moderne Datenanalyse</a>).<a href="einfache-regression.html#fnref6">↩</a></p></li>
<li id="fn7"><p>wobei die 1 für den ersten (einzigen) Prädiktor und <span class="math inline">\(i\)</span> als Index für die <span class="math inline">\(i\)</span>-te Beobachtung steht.<a href="einfache-regression.html#fnref7">↩</a></p></li>
<li id="fn8"><p>intervallskaliertes Kriterium, linearer Zusammenhang zw. Kriterium und Prädiktor(en), Zufallsstichprobe, Normalverteilung der Fehler, Homoskedastizität, Unabhängigkeit der Fehler. Details dazu später.<a href="einfache-regression.html#fnref8">↩</a></p></li>
<li id="fn9"><p>häufig auch als Varianzaufklärung<a href="einfache-regression.html#fnref9">↩</a></p></li>
<li id="fn10"><p>der Ausschluss von Werten ist nur dann erlaubt, wenn eine entsprechende Begründung (nachvollziehbarer Messfehler, falsche Datenübertragung, etc.) vorliegt!<a href="einfache-regression.html#fnref10">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="korrelationen.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Modellbildung.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
